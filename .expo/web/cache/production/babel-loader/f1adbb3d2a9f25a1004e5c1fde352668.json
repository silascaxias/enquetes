{"ast":null,"code":"var _interopRequireWildcard=require(\"@babel/runtime/helpers/interopRequireWildcard\");var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _regenerator=_interopRequireDefault(require(\"@babel/runtime/regenerator\"));var _classCallCheck2=_interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));var _createClass2=_interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));var _inherits2=_interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));var _possibleConstructorReturn2=_interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));var _getPrototypeOf2=_interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));var _react=_interopRequireWildcard(require(\"react\"));var _reactNative=require(\"react-native\");var _reactRedux=require(\"react-redux\");var _api=_interopRequireDefault(require(\"../../network/api\"));var _PollList=require(\"../../actions/PollList\");var _PollVote=require(\"../../actions/PollVote\");var _PollDetails=require(\"../../actions/PollDetails\");var _styles=_interopRequireDefault(require(\"./styles\"));var strings=_interopRequireWildcard(require(\"./strings\"));function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}var PollList=function(_Component){(0,_inherits2.default)(PollList,_Component);var _super=_createSuper(PollList);function PollList(){var _this;(0,_classCallCheck2.default)(this,PollList);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={isLoading:true};_this.fetchPolls=function _callee(){var response,serverError;return _regenerator.default.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _regenerator.default.awrap(_api.default.get('/poll'));case 3:response=_context.sent;if(response.ok){_this.props.setPolls(response.data);_this.setState({isLoading:false});}else{_this.setState({isLoading:false});serverError=response.data.error;_reactNative.Alert.alert(serverError!=null?serverError:response.originalError.message);}_context.next=11;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);_this.setState({isLoading:false});_reactNative.Alert.alert(_context.t0.error.toString());case 11:case\"end\":return _context.stop();}}},null,null,[[0,7]],Promise);};_this.renderItem=function(_ref){var item=_ref.item;return _react.default.createElement(_reactNative.TouchableOpacity,{onPress:function onPress(){_this.props.navigation.navigate('PollDetails');_this.props.setSelectID(item.poll_id);_this.props.setPollDescription(item.poll_description);},style:_styles.default.pollContainer},_react.default.createElement(_reactNative.Text,{style:_styles.default.todoTitle},item.poll_description),_react.default.createElement(_reactNative.Text,{style:_styles.default.productDescription},item.poll_id),_react.default.createElement(_reactNative.TouchableOpacity,{style:_styles.default.button,onPress:function onPress(){_this.props.navigation.navigate('PollVote');_this.props.setSelectID(item.poll_id);}},_react.default.createElement(_reactNative.Text,{style:_styles.default.buttonText},strings.vote)));};return _this;}(0,_createClass2.default)(PollList,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchPolls();}},{key:\"render\",value:function render(){return this.state.isLoading?_react.default.createElement(_reactNative.View,{style:[_styles.default.indicatorContainer,_styles.default.indicatorHorizontal]},_react.default.createElement(_reactNative.ActivityIndicator,{size:\"large\",color:\"#DA552F\"})):_react.default.createElement(_reactNative.View,{style:_styles.default.container},_react.default.createElement(_reactNative.View,{style:_styles.default.listContainer},_react.default.createElement(_reactNative.FlatList,{style:_styles.default.containerList,headerComponent:this.headerComponent,contentContainerStyle:_styles.default.list,data:this.props.pollsList,keyExtractor:function keyExtractor(item){return item.poll_id.toString();},renderItem:this.renderItem})));}}]);return PollList;}(_react.Component);PollList.navigationOptions={title:strings.title};var mapStateToProps=function mapStateToProps(state){return{pollsList:state.pollListReducer.pollsList};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setPolls:function setPolls(polls){return dispatch((0,_PollList.setPolls)(polls));},setSelectID:function setSelectID(id){return dispatch((0,_PollVote.setSelectedID)(id));},setPollDescription:function setPollDescription(description){return dispatch((0,_PollDetails.setPollDescription)(description));}};};var _default=(0,_reactRedux.connect)(mapStateToProps,mapDispatchToProps)(PollList);exports.default=_default;","map":{"version":3,"sources":["/Users/scaxias/Projetos/Estudos/Enquetes/src/screens/PollList/index.js"],"names":["PollList","state","isLoading","fetchPolls","api","get","response","ok","props","setPolls","data","setState","serverError","error","Alert","alert","originalError","message","toString","renderItem","item","navigation","navigate","setSelectID","poll_id","setPollDescription","poll_description","styles","pollContainer","todoTitle","productDescription","button","buttonText","strings","vote","indicatorContainer","indicatorHorizontal","container","listContainer","containerList","headerComponent","list","pollsList","Component","navigationOptions","title","mapStateToProps","pollListReducer","mapDispatchToProps","dispatch","polls","id","description"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {\n  View,\n  Text,\n  FlatList,\n  TouchableOpacity,\n  ActivityIndicator,\n  Alert,\n} from 'react-native';\nimport {connect} from 'react-redux';\nimport api from '../../network/api';\nimport {setPolls} from '../../actions/PollList';\nimport {setSelectedID} from '../../actions/PollVote';\nimport {setPollDescription} from '../../actions/PollDetails';\nimport styles from './styles';\nimport * as strings from './strings';\n\nclass PollList extends Component {\n  static navigationOptions = {\n    title: strings.title,\n  };\n\n  state = {\n    isLoading: true,\n  };\n\n  fetchPolls = async () => {\n    try {\n      const response = await api.get('/poll');\n\n      if (response.ok) {\n        this.props.setPolls(response.data);\n        this.setState({isLoading: false});\n      } else {\n        this.setState({isLoading: false});\n        const serverError = response.data.error;\n        Alert.alert(\n          serverError != null ? serverError : response.originalError.message,\n        );\n      }\n    } catch (err) {\n      this.setState({isLoading: false});\n      Alert.alert(err.error.toString());\n    }\n  };\n\n  componentDidMount() {\n    this.fetchPolls();\n  }\n\n  renderItem = ({item}) => (\n    <TouchableOpacity\n      onPress={() => {\n        this.props.navigation.navigate('PollDetails');\n        this.props.setSelectID(item.poll_id);\n        this.props.setPollDescription(item.poll_description);\n      }}\n      style={styles.pollContainer}>\n      <Text style={styles.todoTitle}>{item.poll_description}</Text>\n      <Text style={styles.productDescription}>{item.poll_id}</Text>\n\n      <TouchableOpacity\n        style={styles.button}\n        onPress={() => {\n          this.props.navigation.navigate('PollVote');\n          this.props.setSelectID(item.poll_id);\n        }}>\n        <Text style={styles.buttonText}>{strings.vote}</Text>\n      </TouchableOpacity>\n    </TouchableOpacity>\n  );\n\n  render() {\n    return this.state.isLoading ? (\n      <View style={[styles.indicatorContainer, styles.indicatorHorizontal]}>\n        <ActivityIndicator size=\"large\" color=\"#DA552F\" />\n      </View>\n    ) : (\n      <View style={styles.container}>\n        <View style={styles.listContainer}>\n          <FlatList\n            style={styles.containerList}\n            headerComponent={this.headerComponent}\n            contentContainerStyle={styles.list}\n            data={this.props.pollsList}\n            keyExtractor={(item) => item.poll_id.toString()}\n            renderItem={this.renderItem}\n          />\n        </View>\n      </View>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    pollsList: state.pollListReducer.pollsList,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    setPolls: (polls) => dispatch(setPolls(polls)),\n    setSelectID: (id) => dispatch(setSelectedID(id)),\n    setPollDescription: (description) =>\n      dispatch(setPollDescription(description)),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PollList);\n"]},"metadata":{},"sourceType":"script"}